Here's a complete example of how to vouch for someone using the MaxFlow API at maxflow.one:

import { ethers } from 'ethers';
// Connect to user's wallet
const provider = new ethers.BrowserProvider(window.ethereum);
const signer = await provider.getSigner();
const endorserAddress = await signer.getAddress();
// Step 1: Fetch the next nonce
const epoch = 1; // Current epoch
const nonceResponse = await fetch(
  `https://maxflow.one/api/nonce/${endorserAddress}/${epoch}`
);
const { nextNonce } = await nonceResponse.json();
// Step 2: Get the chain ID from the user's wallet
const network = await provider.getNetwork();
const chainId = Number(network.chainId);
// Step 3: Create the endorsement data
const endorsement = {
  endorser: endorserAddress.toLowerCase(),
  endorsed: '0x742d35cc6634c0532925a3b844bc9e7595f0beb', // Who you're vouching for
  epoch: epoch,
  nonce: nextNonce,
  timestamp: Math.floor(Date.now() / 1000)
};
// Step 4: Define EIP-712 domain and types
const domain = {
  name: 'MaxFlow',
  version: '1',
  chainId: chainId // Dynamic based on user's wallet network
};
const types = {
  Endorsement: [
    { name: 'endorser', type: 'address' },
    { name: 'endorsed', type: 'address' },
    { name: 'epoch', type: 'uint64' },      // Important: uint64, not uint256
    { name: 'nonce', type: 'uint64' },      // Important: uint64, not uint256
    { name: 'timestamp', type: 'uint64' }   // Important: uint64, not uint256
  ]
};
// Step 5: Sign with EIP-712
const signature = await signer.signTypedData(domain, types, endorsement);
// Step 6: Submit the vouch to MaxFlow API
const response = await fetch('https://maxflow.one/api/vouch', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    endorsement,
    signature,
    chainId
  })
});
if (response.ok) {
  const result = await response.json();
  console.log('Vouch created successfully!', result);
} else {
  const error = await response.text();
  console.error('Failed to create vouch:', error);
}

Key Points:

CORS is enabled - This code runs directly in your browser without CORS errors
EIP-712 types use uint64 - Not uint256 (critical!)
ChainId is dynamic - Based on which network the user's wallet is connected to
Addresses are lowercase - MaxFlow normalizes all addresses
No API key needed - Just wallet signatures for authentication
Quick Integration:

// Just want to read LocalHealth scores? Even simpler:
const scoreResponse = await fetch(
  'https://maxflow.one/api/ego/0x742d35cc6634c0532925a3b844bc9e7595f0beb/score'
);
const { localHealth } = await scoreResponse.json();
console.log(`LocalHealth score: ${localHealth}/100`);

This gives you Sybil-resistant reputation scoring with zero authentication required! ðŸŽ¯